# Яндекс.Деньги

Компонент работает со схемой P2P. Т.е. получение оплаты на кошелек без заключения отдельного договора с Яндексом.

Для того, чтобы принимать оплату через Яндекс.Деньги вам необходимо сначала зарегистрироваться в этой системе и зарегистрировать приложение. При его регистрации, в поле Redirect uri,  нужно указать `http://ВАШ.САЙТ/assets/components/minishop2/payment/yandexmoney.php`, это адрес скрипта, который будет обеспечивать взаимодействие с платежной системой.

## Настройка MODX

После регистрации приложения в его настройках, Вы получаете данные для работы, которые нужно ввести в системные настройки MODX. Кроме того Вы можете указать с кого будет взиматься комиссия системы, с отправителя или получателя платежа (Добавлять к стоимости заказа комисcию по умолчанию с отправителя).

Далее нужно создать несколько ресурсов:

* страница подтверждения платежа
* страница с сообщением об ошибке
* страница с сообщением об успешной оплате (можно использовать страницу корзины, чтоб покупатель видел свой оформленный заказ после оплаты).

Их id также нужно будет указать в системных настройках.

[![](https://file.modx.pro/files/8/c/8/8c8907c8d67793bd1e7bbb27a68060f2s.jpg)](https://file.modx.pro/files/8/c/8/8c8907c8d67793bd1e7bbb27a68060f2.png)

Так же нужно включить новый метод оплаты и назначить его доставке.

[![](https://file.modx.pro/files/a/7/3/a73b1b0fad6377d4858cf8789d99ce5as.jpg)](https://file.modx.pro/files/a/7/3/a73b1b0fad6377d4858cf8789d99ce5a.png)

[![](https://file.modx.pro/files/f/d/b/fdb5c4adc677e9ab011f5023cd290e52s.jpg)](https://file.modx.pro/files/f/d/b/fdb5c4adc677e9ab011f5023cd290e52.png)

## Страница подтверждения платежа.

Тут можно показать пользователю информацию о платеже. Для продолжения оплаты нужно чтобы пользователь отправил форму в которой будет содержаться поле `complite_payment` с любым значением, которое не может быть интерпретировано как false.
Для вывода информации о платеже используйте сниппет mspYandexMoneyConfirm.

## Страница с сообщением об ошибке.

В случае возникновения ошибки на любом этапе проведения операции оплаты пользователь будет перенаправлятся на эту страницу. Тут Вы можете сообщить пользователю что что-то пошло не так, попросить проверить достаточно ли у него средств или связаться с администратором. Сниппет mspYandexMoneyErrors дает возможность получить больше информации об ошибке.

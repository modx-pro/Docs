# mspLiqPay

Все что нужно для подключения интернет-эквайринга от LiqPay — установить компонент, зарегистрировать мерчант на сайте [liqpay.com](http://www.liqpay.com), внести изменения в системные настройки MODX  настройки методов оплаты miniShop2.

## Регистрация в системе LiqPay

Перейдите на сайт [liqpay.com](http://www.liqpay.com). Сам процесс регистрации довольно простой, авторизация происходит через смс-сообщение, которое приходит на ваш телефон. После подключения нового сайта, для вас будут созданы приватный и публичный ключ, который нужно будет внести в настройки MODX.

## Системные настройки MODX

После того, как вы получите приватный и публичный ключ, можно приступить к системным настройкам.
[![](https://file.modx.pro/files/f/3/7/f373caadfc3db81ef547060dc7c5a8b5s.jpg)](https://file.modx.pro/files/f/3/7/f373caadfc3db81ef547060dc7c5a8b5.png)

Для страниц успешной оплаты лучше указать id страницы с корзиной, чтобы покупатель видел свой заказ после возврата с платежного сервиса. Чтобы корректно работала переадресация, у вас должны быть включены дружественные URL.

Обратите внимане на системную настройку **ms2_payment_liqpay_sandbox** - значение **1** означает, что включен тестовый режим и при совершении платежа через систему, деньги с карты взыматься не будут. В рабочем режиме параметр нужно изменить на **0** (тестовый режим выключен).

## Включение метода оплаты

Перейдите в настройки miniShop2, вкладка "Cпособы оплаты" и впишите в поле "Класс обработчик" название класса **LiqPay**.
[![](https://file.modx.pro/files/d/3/b/d3bc7489a8c6d71511891bc383b6ac53s.jpg)](https://file.modx.pro/files/d/3/b/d3bc7489a8c6d71511891bc383b6ac53.png)

## Ссылка на оплату в письме покупателю

Вы можете добавить ссылку на оплату (в случае, если операция оплаты была прервана) в письмо-уведомление клиенту о новом заказе. Для этого просто добавьте в чанк письма плейсхолдер **payment_link**:

``` php
[[+payment_link]]
```

Текст ссылки находится в словаре, ключ **ms2_payment_link** — можно изменить на свое усмотрение.

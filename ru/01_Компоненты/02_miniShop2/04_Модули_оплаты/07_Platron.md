# Platron

Для того, чтобы принимать оплату через Platron вам необходимо сначала [зарегистрировать][1] магазин в этой системе.

## Настройка Platron

В настройках магазина Platron вам нужно указать следующие параметры:

* **secret_key** — платежный пароль, используется для проверки подлинности уведомления об оплате.
* **site_url** — URL сайта магазина для показа покупателю ссылки, по которой он может вернуться на сайт магазина после создания счета.
* Также можете указать в **success_url_method** и **failure_url_method** AUTOGET, в этом случае Platron автоматически будет перенаправлять пользователя на сайт магазина при успешной оплате или ошибке

[![](https://file.modx.pro/files/7/1/7/71711801cfdc221a42bdb30420efc00cs.jpg)](https://file.modx.pro/files/7/1/7/71711801cfdc221a42bdb30420efc00c.png)

## Настройка MODX

В MODX вам нужно настроить следующие параметры (находятся в разделе "Платежи" пространства имен minishop2):

* **Идентификатор магазина в Platron** — узнать его можно в личном кабинете Platron, параметр marchant_id
* **Секретный ключ Platron** — секретный ключ, который ввели в настройках магазина в Platron в пункте 1
* **Страница успешной оплаты Platron** и **страница отказа от оплаты Platron**. Идентификаторы страниц в MODX при успешной оплате или при отмене оплаты соответственно. Рекомендуется указать страницы с корзиной, чтобы покупатель видел свой заказ после возврата с сервиса. При пустых значениях пользователь будет переправлен на главную страницу.

### Дополнительно также можете настроить:

* **Время жизни заказа в секундах** - время (в секундах) в течение которого платеж должен быть завершен, в противном случае при проведении платежа Platron откажет платежной системе в проведении. Минимально допустимое значение: 300 секунд (5 минут). Максимально допустимое значение: 604800 секунд (7 суток).
* **Наименование платежной системы в Platron**. Необязательный параметр. Если его указать, то пользователю будет сразу предложен данный способ оплаты минуя экран выбора. Значения можете узнать в [документации к Platron][2].
* Поля пользователя, которые передаются в Platron при оплате - Platron требует от пользователя контактные данные. В этом параметре можно указать какие поля передавать из свойств пользователя. Если магазин не требует обязательного указания телефона или Email, то можно оставить необходимые поля или поле пустым. В этом случае Platron предложит ввести их на странице оплаты. Возможные значения user_email (требуется только если выбрана платежная система Деньги@mail.ru), contact_user_email (на этот адрес приходят уведомления об изменении состояния транзакций), user_phone (контактный телефон пользователя, необходим для идентификации пользователя. Для России должен начинаться с 79).

[![](https://file.modx.pro/files/3/1/a/31a602fe1a8c96ce786dba8fb69d55cas.jpg)](https://file.modx.pro/files/3/1/a/31a602fe1a8c96ce786dba8fb69d55ca.png)

Также не забудьте включить новый метод оплаты и назначить его в вариантах доставки.

[![](https://file.modx.pro/files/b/c/2/bc2e13f247f84a5a2f9944d91f72f66bs.jpg)](https://file.modx.pro/files/b/c/2/bc2e13f247f84a5a2f9944d91f72f66b.png)

[1]: https://www.platron.ru/join.php "Регистрация магазина в сиситеме Platron"
[2]: https://www.platron.ru/PlatronAPI.pdf "Техническое описание (API) системы Platron"

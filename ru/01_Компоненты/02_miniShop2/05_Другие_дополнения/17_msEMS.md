# msEMS

С версии 2.0 компонент полностью изменён и не совместим с более старыми версиями. В частности это проявляется в отсутствии возможности выбрать город из списка предлагаемых, как было ранее, соответственно контроль правильности ввода названия города всецело ложится на плечи разработчика сайта, компонент же просто предоставляет возможность рассчитать стоимость доставки.

Перед началом использования компонента, его необходимо настроить, иначе он завалит журнал ошибок информацией о сбоях и считать ничего не будет. Для этого перейдите в системные настройки, пространство имён "minishop2" раздел "Доставка EMS" и укажите следующие данные:

* Время кэширования результатов запроса в секундах (ms2_ems_cache_time). Бесплатное использование Postcal позволяет делать не более 500 запросов к сервису в сутки, потому кэшировать необходимо.
* Вес отправления по умолчанию в граммах (ms2_ems_default_weight). Это значение будет использоваться если на сайте не указывается вес товаров и соответственно вес корзины выходит 0. Не может превышать 100 кг.
* Город из которого отправляются заказы (ms2_ems_delivery_from). Это обязательный параметр, без него ничего работать не будет.
* E-mail разработчика сайта (ms2_ems_developer_email). Администратор сервиса Postcalc выдвигает требование чтоб этот параметр указывался в запросах, на случай если потребуется связаться с разработчиком. Если не заполнять этот параметр, то будет использован e-mail администратора по умолчанию (emailsender)
* Оценка товарного вложения (ms2_ems_valuation). Может быть указана в процентах от стоимости корзины или в рублях. Не может быть больше чем 100 000р.
* Множитель веса (ms2_ems_weight_rate). Для расчётов нужен вес в граммах, а у товаров он может быть указан в килограммах или миллиграммах, а может кто-то пудами меряет или, чего доброго, фунтами... Так вот, чтоб всё работало правильно, нужно указать на сколько умножать значение веса товара из его свойства, чтоб получить правильный вес в граммах.

**Важно! По условиям использования сервиса Postcalc, на сайте необходимо разместить ссылку на сайт проекта (postcalc.ru) в произвольной форме. А так же по условия сервиса Postcalc, если число запросов вашего интернет-проекта к API превышает 500 запросов в сутки, вам необходимо перейти на платный доступ. [http://postcalc.ru/conditions.html][1]**

[1]: http://postcalc.ru/conditions.html

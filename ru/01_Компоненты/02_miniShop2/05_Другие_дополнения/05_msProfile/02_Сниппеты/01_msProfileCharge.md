# msProfileCharge

Сниппет для пополнения внутреннего счета пользователя.

| Название             | По умолчанию                 | Описание                                                                                                                                   |
| -------------------- | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| **&tplForm**         | tpl.msProfile.charge.form    | Чанк оформления формы пополнения счета. Можно использовать @INLINE чанки без вызова фильтров и сниппетов.                                  |
| **&tplPayment**      | tpl.msProfile.charge.payment | Чанк оформления одного метода оплаты. Можно использовать @INLINE чанки без вызова фильтров и сниппетов.                                    |
| **&tplOrder**        | tpl.msOrder.success          | Чанк оформления успешного проведения заказа. По умолчанию используется чанк из miniShop2 - tpl.msOrder.success.                            |
| **&payments**        |                              | Список id способов оплаты через запятую. Если указать id с минусом, то способ будет исключен из выборки.                                   |
| **&sortby**          | order                        | По какому полю сортировать вывод методов оплаты.                                                                                           |
| **&sortdir**         | ASC                          | Направление сортировки: по возрастанию или убыванию.                                                                                       |
| **&limit**           | 0                            | Лимит выборки.                                                                                                                             |
| **&outputSeparator** | \n                           | Символ для разделения вывода результатов, по умолчанию - перенос строки.                                                                   |
| **&minSum**          | 200                          | Минимальная сумма для пополнения счета.                                                                                                    |
| **&maxSum**          | 0                            | Максимальная сумма для пополнения счета.                                                                                                   |
| **&showInactive**    | true                         | Показывать неактивные методы оплаты. По умолчанию - да, чтобы можно было использовать те методы, которые отключены для оплаты в miniShop2. |

При вызове сниппета на странице выводится форма пополнения счета. Для операции пополнения используются установленные методы [miniShop2][1].

Обратите внимание, что вы можете настроить магазин таким образом, что все реальные покупки будут проходить только со счета пользователя, а пополнять этот счет он сможет через имеющиеся платежные методы.
Для этого, вам нужно отключить все методы в настройках miniShop2 (кроме CustomerAccount), чтобы они не появлялись при оформлении заказа.
При этом сниппет msProfileCharge всё равно будет их использовать - за это отвечает параметр `&showInactive`.

Помимо этого параметры вы можете точно указывать, какие методы включить или исключить из работы параметром `&payments`.

При пополнении счета создаётся стандартный заказ miniShop2, в который вписывается несуществующий, виртуальный товар "Пополнение счета", и пользователю отправляется письмо об этом.
Для работы виртуальных товаров необходима версия [miniShop2 2.1.8][2] и выше.

[1]: /ru/01_Компоненты/02_miniShop2/
[2]: http://modx.pro/components/3395-minishop2-version-2-1-8-beta-product-names/

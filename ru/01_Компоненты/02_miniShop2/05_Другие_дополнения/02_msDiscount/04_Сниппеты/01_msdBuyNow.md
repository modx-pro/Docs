# msdBuyNow

Сниппет для вывода блока «Успей купить», который показывает время окончания акции на товары.

Выбирает id нужных товаров и передаёт их в сниппет msProducts.
Следовательно, **помимо свобственных параметров, принимает и все параметры msProducts**.

## Параметры

| Название          | По умолчанию                    | Описание                                                         |
| ----------------- | ------------------------------- | ---------------------------------------------------------------- |
| **&sale**         |                                 | Список акций для вывода, через запятую. Если пусто, выведет все. |
| **&tpl**          | tpl.msProducts.discount.row     | Чанк оформления для вывода результата работы сниппета.           |
| **&frontend_css** | [[+assetsUrl]]css/web/main.css  | Файл с css стилями для подключения на фронтенде.                 |
| **&frontend_js**  | [[+assetsUrl]]js/web/default.js | Файл с javascript для подключения на фронтенде.                  |
| **&force_date**   | 1                               | Выводить товары только из акций с ограничением по времени.       |

По умолчанию сниппет выводит все товары из акций с ограничением по времени.
Безвременные акции будут выводиться только при указании пустого параметра `&force_date`

Это может быть полезным для вывода всех товаров со скидкой, например, в [mFilter2][1]:

``` php
[[!mFilter2?
    &parents=`0`
    &element=`msdBuyNow`
    &force_date=`0`
    &...
]]
```

### Обратный отсчет

В комплекте идет js-файл, запускающий обратный отсчет до конца акции. Он получает количество оставшихся секунд и преобразует их в счетчик:

``` html
<span class="msd_remains" data-remain="1473652">
    <span class="days">17</span>
    <span class="hours">01</span>
    <span class="minutes">20</span>
    <span class="seconds">52</span>
</span>
```

Для оформления внешнего вида счетчика можно использовать CSS стили `.msd_remains span {}`, `.msd_remains .days {}` и т. д.

## Примеры

Так как сниппет выводит количество секунд, оставшихся до окончания акции, **он должен вызываться некэшированным**.

Обычный вызов для вывода товаров по временным акциям:

``` php
[[!msdBuyNow]]
```

Вывод с постраничной разбивкой:

``` php
[[!pdoPage?
    &element=`msdBuyNow`
]]
[[!+page.nav]]
```

Вывод с указанием параметров для msProducts:

``` php
[[!pdoPage?
    &element=`msdBuyNow`
    &sale=`1,2,3,4,5`
    &includeTVs=`type`
    &sortby=`type`
    &includeThumbs=`120x90`
]]
[[!+page.nav]]
```

[1]: /ru/01_Компоненты/03_mSearch2/01_Сниппеты/02_mFilter2.md

# msOrder

Сниппет оформления заказа.

[![](https://file.modx.pro/files/4/b/b/4bb767c02e0e7b09ddae5e426b34c7e6s.jpg)](https://file.modx.pro/files/4/b/b/4bb767c02e0e7b09ddae5e426b34c7e6.png)

## Параметры

| Параметр       | По умолчанию | Описание                                                                                                             |
| -------------- | ------------ | -------------------------------------------------------------------------------------------------------------------- |
| **tpl**        | tpl.msOrder  | Чанк оформления                                                                                                      |
| **userFields** |              | Ассоциативный массив соответствия полей заказа полям профиля пользователя в формате "поле заказа" => "поле профиля". |
| **showLog**    |              | Показывать дополнительную информацию о работе сниппета. Только для авторизованных в контекcте "mgr".                 |

*Можно использовать и другие [общие параметры pdoTools][1]*

## Оформление

Сниппет рассчитывает на работу с [чанком Fenom][1]. Он передаёт в него 5 переменных:

- **order** - массив заказа из сессии пользователя
  - **delivery** - выбранный способ доставки
  - **payment** - выбранный способ оплаты
  - **cost** - общая стоимость заказа
- **deliveries** - массив доступных свойств доставки заказа покупателю
- **payments** - массив способов оплаты
- **form** - массив с заполненными данными от покупателя. Там могут быть:
  - **email** - адрес покупателя
  - **receiver** - имя получателя
  - **phone** - телефон
  - **index** - почтовый индекс
  - **region** - область
  - **city** - город
  - **street** - улица
  - **building** - дом
  - **room** - комната
  - могут быть и другие значения, заданные при помощи параметра **&userFields**
- **errors** - массив полей формы, заполненных с ошибками

### Плейсхолдеры

Вы можете увидеть все доступные плейсхолдеры заказа просто указав пустой чанк:

``` php
<pre>[[!msOrder?tpl=``]]</pre>
```

[![](https://file.modx.pro/files/7/3/e/73ea6a3680166bb81a59b0dd55475614s.jpg)](https://file.modx.pro/files/7/3/e/73ea6a3680166bb81a59b0dd55475614.png)

## Создание заказа

Данный сниппет рекомендуется вызывать в связке с другими на странице оформления заказа:

```php
[[!msCart]] <!-- Просмотр и изменение корзины, скрывается после создания заказа -->

[[!msOrder]] <!-- Форма оформления заказа, скрывается после его создания -->

[[!msGetOrder]] <!-- Вывод информации о заказе, показывается после его создания -->
```

## Примеры

Указываем получать имя авторизованного пользователя не из `fullname`, а из `username`:

``` php
[[!msOrder?
    &userFields=`{"receiver":"username"}`
]]
```

[1]: /ru/01_Компоненты/01_pdoTools/03_Парсер.md

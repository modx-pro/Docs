# Дополнительный функционал

Помимо модульной архитектуры и контроллеров, Office добаляет и несколько приятных мелочей в систему.

## Авторизация из админки

Вы можете авторизоваться под любым активным пользователем прямо из админки.

Для этого добавлен пункт в меню пользователя:
[![](https://file.modx.pro/files/4/e/4/4e46cdfd6032d8d234bd6fed1520e934s.jpg)](https://file.modx.pro/files/4/e/4/4e46cdfd6032d8d234bd6fed1520e934.png)

И кнопка на панели редактирования пользователя:
[![](https://file.modx.pro/files/f/8/0/f802f7abeab90a1a6bf8faec7f8d4e88s.jpg)](https://file.modx.pro/files/f/8/0/f802f7abeab90a1a6bf8faec7f8d4e88.png)

- Авторизация всегда происходит в новом окне, текущее окно менеджера не закрывается.
- Скрипт пытается авторизоваться во всех контекстах.
- Вы можете использовать прямые ссылки на авторизацию, вида
  
```plain
http://your.site/?action=office/login_as&user_id=4
```

или даже

```plain
http://your.site/any/page/?action=office/login_as&user_id=2&any_key=value
```

Такие ссылки обрабатываются плагинами Office, так что их можно указывать на любую страницу.

## Завершение сеанса неактивного пользователя

Есть такая проблема в MODX, что при блокировке или деактивации пользователя, его сессия остаётся активной и он даже не подозревает, что его отключили.

Office автоматически решает эту проблему, завершая сессию такого пользователя при первом же запросе любой страницы.

## Переключение аккаунтов

В версии 1.6 появился функционал авторизации в несколько аккаунтов с возможностью переключения между ними
[![](https://file.modx.pro/files/1/e/a/1eab19e934b92ddb79008c8ce5b23427s.jpg)](https://file.modx.pro/files/1/e/a/1eab19e934b92ddb79008c8ce5b23427.png)

При такой дополнительной авторизации вы входите в аккаунт нового юзера, но старые аккаунты остаются в сессии `$_SESSION['Office']['LoggedIn']`, после чего вы можете переключаться между ними ссылкой вида:

```plain
https://your.site/?action=auth/change&user_id=4
```

Вы можете отключить такой аккаунт ссылкой

```plain
https://your.site/?action=auth/logout&user_id=4
```

Ну а сама авторизация работает как обычная форма авторизации, за исключением:

- действие там `auth/formAdd`, вместо `auth/formLogin`
- при незаполненном пароле будет ошибка, вместо отправки письма для сброса.

Если вы выходите из текущего аккаунта, но у вас есть и другие авторизации, то вы будете переключены на одну из них.

При авторизации под другим юзером из админки, он также попадает в этот массив дополнительных юзеров, и админ не теряет свою авторизацию.

А если такой аккаунт сменит свой пароль, то переключиться на него вы уже не сможете, потребуется повторная авторизация.
Это защита на тот случай, когда, например, один пользователь даёт свой сайты под управление другому, а потом вдруг передумывает.

# История заказов MS2

Сниппет **OfficeMiniShop2** выводит историю заказов miniShop2 текущего пользователя.

Всё построено на ExtJS - это очень удобно. Сам он загружается из установленного MODX, поэтому на разных версиях MODX он может выглядеть немного по разному.

[![](https://file.modx.pro/files/c/b/f/cbf808da0f481e1c746144a9549c61ccs.jpg)](https://file.modx.pro/files/c/b/f/cbf808da0f481e1c746144a9549c61cc.png)
[![](https://file.modx.pro/files/8/f/e/8fe7aa15248aa16bf8f4509e15093fd5s.jpg)](https://file.modx.pro/files/8/f/e/8fe7aa15248aa16bf8f4509e15093fd5.png)
[![](https://file.modx.pro/files/9/7/d/97d83a9dad06a604428a859f391110fds.jpg)](https://file.modx.pro/files/9/7/d/97d83a9dad06a604428a859f391110fd.png)

Настройки вывода таблицы заказов работают примерно так же, как и у miniShop2:

[![](https://file.modx.pro/files/6/f/2/6f2a563d97bbea76516b74dc9c80baads.jpg)](https://file.modx.pro/files/6/f/2/6f2a563d97bbea76516b74dc9c80baad.png)
[![](https://file.modx.pro/files/c/a/1/ca1a88011b00b8c35f17a0858cb9e531s.jpg)](https://file.modx.pro/files/c/a/1/ca1a88011b00b8c35f17a0858cb9e531.png)

Можно указать свой CSS файл с офрмлением ExtJS.

В отличие от miniShop2, вы еще можете указать 3 дополнительных параметра сниппету:

* **allowRemove** - включить возможность удаления заказов со статусом "Новый".
* **allowRepeat** - включить возможность повторения заказа.
* **cartLink** - ссылка на корзину с оформлением заказа.

Логика работы повтора заказа следующая:

1. Если повтор разрешён, в таблице заказов появляется соответствующая иконка.
2. При клике на неё товары заказа набиваются в сессию, как будто бы пользователь сам добавил их в корзину.
3. Дальше, если параметр **cartLink** не пуст, то пользователь переправляется на указанную страницу оформления заказа.
Выбирает метод доставки, оплаты, заполняет или меняет нужные поля адреса.
4. Если же этот параметр пуст, то заказ создаётся сразу же, копирую всё что можно из старого.

Обратите внимание, что если копируемый заказ был создан давно, и с тех пор ваши правила оформления изменились, создание заказа без корзины может выдать ошибку.
Например, теперь вы требуете обязательно указывать адрес, а в копируемом заказе его нет - будет ошибка о незаполнении нужных полей.

```php
[[!officeMiniShop2?
    &allowRemove=`1`
    &allowRepeat=`1`
    &cartLink=`/order/cart`
]]
```

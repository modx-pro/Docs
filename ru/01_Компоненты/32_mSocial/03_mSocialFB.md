# mSocialFB

Модуль реализует постинг в социальную сеть Facebook на основе расширения mSocial.

* Устанавливаем mSocialFB (mSocial устанавливается сам если его нет).
* Регистрируемся в Facebook, авторизовываемся.
* Менеджер приложений находится [тут][1], переходим.
* Создаем приложение (вводим название, выбираем категорию).
[![](https://file.modx.pro/files/a/4/7/a472e5e913b92dd927a886696853de28s.jpg)](https://file.modx.pro/files/a/4/7/a472e5e913b92dd927a886696853de28.png)
[![](https://file.modx.pro/files/4/e/7/4e7725932f2903a4bfb009e9b20270acs.jpg)](https://file.modx.pro/files/4/e/7/4e7725932f2903a4bfb009e9b20270ac.png)
[![](https://file.modx.pro/files/7/d/3/7d3cbe2842c43b7c73b304daa6d0aa9cs.jpg)](https://file.modx.pro/files/7/d/3/7d3cbe2842c43b7c73b304daa6d0aa9c.png)
* Пропускаем быстрый старт.
* Копируем App ID и App Secret.
[![](https://file.modx.pro/files/e/4/0/e409d4a49a8987b7dfa3f1940d980470s.jpg)](https://file.modx.pro/files/e/4/0/e409d4a49a8987b7dfa3f1940d980470.png)
* Переходим в [Graph API Explorer][2] в нем мы сможем создать токен.
[![](https://file.modx.pro/files/1/3/1/131abd100a39cc4fda49ddff107b6b5ds.jpg)](https://file.modx.pro/files/1/3/1/131abd100a39cc4fda49ddff107b6b5d.png)
* Выбираем наше приложение и жмем на Get User Access Token.
* Выбираем нужные права и подтверждаем их.
[![](https://file.modx.pro/files/0/f/5/0f50553e147706a7c7746a6676b2dc60s.jpg)](https://file.modx.pro/files/0/f/5/0f50553e147706a7c7746a6676b2dc60.png)
* Копируем полученный токен.
* Заменяем поля в строке на наши: <https://graph.facebook.com/oauth/access_token?client_id={App> ID}&client_secret={App Secret}&grant_type=fb_exchange_token&%20fb_exchange_token={token} переходим по получившейся ссылке в любом браузере.
* Копируем получившийся токен (будте внимательнее, в конце строки есть переменная &expires=5183999, её не копируем).
* Прекрасно токен у нас есть (в будущем я обязательно сделаю фичу что бы токены брались динамически, но пока придется делать это вручную).
* Для постинга нам потребуется id страницы на которую будем размещать посты, с группой и страницей все просто id содержится в строке. Однако со страницей пользователя не все так просто. Тот id который строит в строке поиска, не является нужным. Что бы его получить нам потребуется все тот же [Graph API Explorer][2]. Переходим. Выбираем метод GET и пишем в строке me. Выполняем. Получаем наш id, это и будет идентификатор страницы юзера.

## Системные настройки

| Имя               | По умолчанию   | Описание                               |
| ----------------- | -------------- | -------------------------------------- |
| **msocial_fb_at** | Пусто          | Access Token для Facebook.             |
| **msocial_fb_id** | Пусто          | Id страницы профиля, группы, страницы. |
| **msocial_fb_tp** | tpl.msocial.fb | Чанк шаблона для постинга в Facebook.  |
| **msocial_fb_lk** | 0              | Размещать ли ссылку ресурса.           |

## Содержимое модуля

TVs

* **fbPost** - tv для отслеживания постинга в Facebook.

Чанки

* **tpl.msocial.fb** - шаблон для постинга в Facebook.
**В чанке можно использовать все поля документа, а так же TV поля.**

## Информация о прикрепляемых изображениях для Facebook.

Для того что бы изображения корректно загружались нужно что бы они присутствовали в теле сообщения, в виде

```html
<img src="путь до изображения"/>
```

Например можно вставлять изображения в тело поля content с помощью редактора TinyMCE. Путь к изображению должен быть следующего вида `files/mSocial.jpg`.

Facebook поддерживаются следующие форматы: PNG, JPEG, WEBP и GIF.

[1]: https://developers.facebook.com/
[2]: https://developers.facebook.com/tools/explorer/

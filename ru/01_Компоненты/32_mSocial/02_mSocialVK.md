# mSocialVK

Модуль реализует постинг в социальную сеть Вконтакте на основе расширения mSocial.

* Устанавливаем mSocialVK (mSocial устанавливается сам если его нет).
* Регистрируемся в Вконтакте, авторизовываемся.
* Менеджер приложений находится [тут][1], переходим.
* Создаем приложение в Вк.
* Указываем название, выбираем тип приложения **Standalone**.
* Не забываем включить приложение, изменив селект *Состоятние* и сохраняем изменения.
* Переходим в настройки и копируем ID приложения. Заменяем {ID приложения} в строке ```https://oauth.vk.com/authorize?client_id={ID приложения}&scope=groups,wall,offline,photos&redirect_uri=https://oauth.vk.com/blank.html&display=page&v=5.21&response_type=token``` на наш ID приложения и вставляем в строку броузера.
* В появившемся окне нажимаем разрешить.
* Получаем строку следущего вида ```https://oauth.vk.com/blank.html#access_token=349252841f7c58495dd5692d8b55ab6460ec23aa60dsfdsfdsfdsfdsfdsfdsfsdfsdfsddfsddfcx&expires_in=0&user_id=30314063``` копируем access_token в блокнотик.
* Теперь открываем наш сайт. Переходим в Системные настройки / mSocial и прописываем нужные параметры.
* Открываем чанк tpl.msocial.vk или тот который используется для постинга, вносим нужные параметры для постинга. Пример: `[[+pagetitle]]` - `[[+content]]`
* Теперь осталось только включить tv-параметр vkPost для тех шаблонов, документы которых должны участвовать в постинге. Постинг происходит при сохранении ресурса, в том случае если tv-параметр vkPost переключен на Да.

## Системные настройки

| Имя               | По умолчанию   | Описание                                                                                                                                                                                                              |
| ----------------- | -------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **msocial_im_fg** | 0              | Постить от имени группы, если постим в группу.                                                                                                                                                                        |
| **msocial_vk_at** | Пусто          | Access Token для Вконтакте.                                                                                                                                                                                           |
| **msocial_vk_id** | Пусто          | Id страницы соцсети Вконтакте куда будем добавлять сообщения. Если вы хотите добавлять в группу то указывайте идентификатор с приставленным минусом. То есть если id вашей группы 32432432432 вставляем -32432432432. |
| **msocial_vk_tp** | tpl.msocial.vk | Чанк шаблона для постинга в Вконтакте                                                                                                                                                                                 |

## Содержимое компонента

TVs
    * **vkPost** - tv для отслеживания постинга в Вконтакте.

Чанки
    * **tpl.msocial.vk** - шаблон для постинга в Вконтакте.
    **В чанке можно использовать все поля документа, а так же TV поля.**

## Информация о прикрепляемых изображениях для Вконтакте.

Для того что бы изображения корректно загружались нужно что бы они присутствовали в теле сообщения, в виде

```html
<img src="путь до изображения"/>
```

Например можно вставлять изображения в тело поля content с помощью редактора TinyMCE. Путь к изображению должен быть следующего вида `files/mSocial.jpg`.

Вконтакте поддерживаются следующие форматы: PNG, JPEG, WEBP и GIF.

[1]: https://vk.com/apps?act=manage

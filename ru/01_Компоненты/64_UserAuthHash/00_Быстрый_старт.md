# UserAuthHash

Компонент реализует авторизацию пользователя по хэш-коду.

Попробовать пакет перед покупкой можно на [modhost.pro][4].

## Особенности

- авторизация без ввода логина и пароля, переходом на сайт по ссылке с хэш-кодом
- можно включить/выключить возможность авторизации по хэш-коду, задать время жизни хэш-кода, указать контексты авторизации

## Установка

- [Подключите наш репозиторий][002]
- Установите **UserAuthHash**

Попробовать пакет перед покупкой можно на [modhost.pro][4], на нём эти дополнения можно выбрать прямо при создании сайта.

## Описание

Компонент UserAuthHash позволяет авторизовать пользователя без ввода логина и пароля, переходом на сайт с хэш-кодом. 

Можно задать время жизни хэш-кода, указать контексты авторизации

## Сниппет генерации хэш-кода авторизации `UserAuthHash`

### Параметры

| Параметр    | По умолчанию  | Описание                                                                  |
| ----------------- | --------------| ------------------------------------------------------------------------- |
| **user**          |               | Идентификатор пользователя. Id, либо email пользователя                   |
| **loginContext**  |               | Контексты для авторизации, через запятую. Например, &contexts=`web,ru,en` |
| **excludeContext**|               | Исключаемые контексты, через запятую.                                     |
| **lifeTime**      |     1h        | Время жизни хэш-кода авторизации. Например, &lifeTime=`1h` - 1 час        |


### Пример вызова

стандарнтый синтаксис

```
<a href="[[++site_start]]?auth_hash=[[!UserAuthHash?&user=`2`&lifeTime=`1h`]]"&msorder=1>Заказы</a>
```

синтаксис феном

```
{set $args = [
'msorder' => 1,
'auth_hash' => ('!UserAuthHash'|snippet:['user' => 2,'lifeTime' => '1h'])
]}
<a href="{'site_start'|option|url:['scheme' => 'full','xhtml_urls' => 0]:$args}">Заказы</a>
```

синтаксис феном модификатор

```
{set $args = [
'msorder' => 1,
'auth_hash' => (['user' => 'test@gmail.com','lifeTime' => '1h']|getAuthHash)
]}
<a href="{'site_start'|option|url:['scheme' => 'full','xhtml_urls' => 0]:$args}">Заказы</a>

```

## Примечание

Авторизация не работает:
 - для пользователей с ключем `sudo`
 - для заблокированных пользователей
 - в контекст `mgr`
 

[2]: https://modstore.pro/info/connection
[4]: https://modhost.pro

[0101]: /ru/01_Компоненты/01_pdoTools/
[010103]: /ru/01_Компоненты/01_pdoTools/03_Парсер.md
[0102]: /ru/01_Компоненты/02_miniShop2/
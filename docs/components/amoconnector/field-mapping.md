# Маппинг полей

Компонент использует гибкую систему маппинга полей для передачи данных из заказов и форм в amoCRM.

## Панель управления

Маппинг настраивается в CMP: **Приложения** → **amoConnector** → вкладка **Маппинг полей**.

Каждая запись маппинга содержит:

| Поле | Описание |
|------|----------|
| **Контекст** | `order` (заказы ms2) или `form` (формы) |
| **Исходное поле** | Имя поля в MODX (например, `receiver`, `email`, `cost`) |
| **Целевая сущность** | `lead` (сделка) или `contact` (контакт) |
| **Целевое поле** | Стандартное поле amoCRM (`name`, `email`, `phone`, `price`) или ID кастомного поля |
| **Активно** | Вкл/выкл отдельной записи маппинга |

## Предустановленные маппинги

При установке создаются маппинги по умолчанию:

### Заказы → Контакт

| Исходное поле | Поле amoCRM |
|---------------|-------------|
| `receiver` | `name` |
| `email` | `email` |
| `phone` | `phone` |

### Заказы → Сделка

| Исходное поле | Поле amoCRM |
|---------------|-------------|
| `cost` | `price` (бюджет) |

### Формы → Контакт

| Исходное поле | Поле amoCRM |
|---------------|-------------|
| `name` | `name` |
| `email` | `email` |
| `phone` | `phone` |

## Доступные поля заказов

При установке также создаются неактивные маппинги для всех доступных полей:

- **msOrder**: `num`, `cart_cost`, `delivery_cost`, `weight`
- **Сущности**: `status_name`, `delivery_name`, `payment_name`
- **msOrderAddress**: `country`, `index`, `region`, `city`, `metro`, `street`, `building`, `entrance`, `floor`, `room`, `comment`, `text_address`
- **Синтетические**: `_products_text` (текст товаров), `_products_count` (количество товаров)

Для активации перейдите в CMP, включите нужные поля и укажите для них целевые поля amoCRM.

## Кастомные поля amoCRM

Для маппинга на кастомные поля amoCRM укажите в столбце **Целевое поле** числовой ID поля из amoCRM. ID кастомных полей можно узнать через CMP (при загрузке полей из API) или в интерфейсе amoCRM.

# Наборы фильтров

Центральная сущность mFilter — определяет какие фильтры доступны на страницах каталога.

## Создание набора

1. Нажмите **Создать**
2. Заполните основные данные:
   - **Название** — для идентификации в админке
   - **Описание** — опционально
   - **Активен** — включить/выключить

## Вкладки набора

### Фильтры

Список фильтров в наборе. Для каждого фильтра:

| Поле | Описание |
|------|----------|
| **Ключ** | Уникальный идентификатор (vendor, color, price) |
| **Тип** | Тип фильтрации (default, number, boolean, vendors...) |
| **Источник** | Откуда брать данные (option, tv, field, resource) |
| **Поле** | Имя поля/опции (для source=option, tv, field) |
| **Название** | Отображаемое название |
| **Активен** | Включён ли фильтр |
| **Порядок** | Сортировка в форме |

### Типы фильтров

| Тип | Описание | UI |
|-----|----------|-----|
| `default` | Стандартный | Чекбоксы |
| `number` | Числовой диапазон | Слайдер + инпуты |
| `boolean` | Да/Нет | Переключатель |
| `vendors` | Производители MS3 | Чекбоксы |
| `parents` | Родительские категории | Чекбоксы |
| `colors` | Цвета (с HEX) | Цветные плашки |
| `date` | Диапазон дат | Датапикер |
| `year` | По годам | Чекбоксы |
| `month` | По месяцам | Чекбоксы |

### Источники данных

| Источник | Описание | Поле |
|----------|----------|------|
| `option` | Опции MiniShop3 | Имя опции (color, size) |
| `tv` | Template Variables | Имя TV |
| `field` | Поля ресурса | Имя поля (pagetitle, template) |
| `resource` | Поля msProduct/msCategory | Поле Data (price, weight) |
| `ms3` | Специальные поля MS3 | vendor, category |

### Привязки

Определяет на каких страницах работает набор фильтров.

**Дерево ресурсов:**
- Выберите категории каталога
- Отметьте галочкой нужные ресурсы

**Опции:**
- **Включить дочерние** — набор будет работать и на дочерних страницах

### Настройки

Дополнительные настройки набора:

| Настройка | Описание |
|-----------|----------|
| **Сортировка по умолчанию** | Поле сортировки результатов |
| **Направление сортировки** | ASC или DESC |
| **Лимит по умолчанию** | Элементов на странице |
| **Показывать пустые** | Показывать фильтры без значений |

## Примеры конфигурации

### Каталог товаров MS3

```json
{
    "vendor": {
        "type": "vendors",
        "source": "ms3",
        "label": "Производитель"
    },
    "color": {
        "type": "colors",
        "source": "option",
        "field": "color",
        "label": "Цвет"
    },
    "size": {
        "type": "default",
        "source": "option",
        "field": "size",
        "label": "Размер"
    },
    "price": {
        "type": "number",
        "source": "resource",
        "field": "Data.price",
        "label": "Цена"
    },
    "new": {
        "type": "boolean",
        "source": "resource",
        "field": "Data.new",
        "label": "Новинка"
    }
}
```

### Каталог с TV

```json
{
    "brand": {
        "type": "default",
        "source": "tv",
        "field": "product_brand",
        "label": "Бренд"
    },
    "material": {
        "type": "default",
        "source": "tv",
        "field": "product_material",
        "label": "Материал"
    },
    "year": {
        "type": "year",
        "source": "tv",
        "field": "product_year",
        "label": "Год выпуска"
    }
}
```

### Каталог статей

```json
{
    "category": {
        "type": "parents",
        "source": "resource",
        "label": "Категория"
    },
    "author": {
        "type": "default",
        "source": "field",
        "field": "createdby",
        "label": "Автор"
    },
    "date": {
        "type": "month",
        "source": "field",
        "field": "publishedon",
        "label": "Дата публикации"
    }
}
```

## Удаление набора

При удалении набора:
- Удаляются все привязки к ресурсам
- Слаги и SEO шаблоны сохраняются

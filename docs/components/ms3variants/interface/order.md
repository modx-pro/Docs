---
title: Варианты в заказе
---
# Варианты в заказе

При редактировании заказа MiniShop3 доступен функционал выбора и изменения вариантов товаров.

## Отображение вариантов

<!-- Скриншот: таблица товаров в заказе с вариантами -->

В таблице товаров заказа варианты отображаются:
- В колонке **Опции** — комбинация опций варианта
- Цена товара — цена выбранного варианта
- Артикул — SKU варианта (если задан)

## Выбор варианта при добавлении товара

При добавлении товара с вариантами в заказ:

1. Выберите товар в окне поиска
2. Если у товара есть варианты, появится селектор
3. Выберите нужный вариант из списка
4. Нажмите **Применить**

<!-- Скриншот: выбор варианта при добавлении товара -->

### Информация о вариантах

В селекторе отображается:
- Комбинация опций (цвет, размер и т.д.)
- Цена варианта
- Доступный остаток

## Изменение варианта

Для изменения варианта уже добавленного товара:

1. Найдите товар в таблице заказа
2. Нажмите кнопку **Вариант** в строке товара
3. Выберите новый вариант
4. Нажмите **Применить**

<!-- Скриншот: изменение варианта товара в заказе -->

::: warning Пересчёт стоимости
При изменении варианта автоматически пересчитывается:
- Цена позиции
- Стоимость позиции (цена × количество)
- Общая стоимость заказа
:::

## Сброс варианта

Для возврата к базовому товару (без варианта):

1. Нажмите кнопку **Вариант** в строке товара
2. Выберите опцию **Базовый товар**
3. Нажмите **Применить**

Товар будет использовать цену из карточки товара.

## Опции в заказе

Опции выбранного варианта сохраняются в поле `options` позиции заказа:

```json
{
    "_variant_id": 5,
    "color": "red",
    "size": "XL"
}
```

Это позволяет:
- Отображать опции в email-уведомлениях
- Показывать опции в истории заказов клиента
- Использовать в печатных формах

## Контроль остатков

При работе с заказами учитываются остатки вариантов:

### При добавлении
- Нельзя добавить больше, чем есть на складе
- Отображается доступное количество

### При изменении количества
- Проверяется доступный остаток
- Выводится предупреждение при превышении

### Списание остатков

Остатки списываются при достижении статуса, указанного в настройке `ms3variants_deduct_stock_status`.

**Пример:**
1. Создан заказ с вариантом (остаток: 10)
2. Заказ переведён в статус "Оплачен" (ID: 2)
3. Если `ms3variants_deduct_stock_status = 2`, остаток уменьшается
4. Новый остаток: 10 - количество в заказе

::: tip Отмена заказа
При отмене заказа остатки автоматически не восстанавливаются. Для возврата остатков используйте ручное редактирование варианта или специальный плагин.
:::

---
title: Системные настройки
---
# Системные настройки

Все настройки имеют префикс `ms3recentlyviewed.` и находятся в пространстве имён **ms3recentlyviewed**.

**Где изменить:** **Управление → Системные настройки** (в MODX 3: **Настройки → Системные настройки**) — фильтр по пространству имён `ms3recentlyviewed`.

## Таблица настроек

| Настройка | Описание | По умолчанию | Рекомендации |
|-----------|----------|--------------|--------------|
| `ms3recentlyviewed.max_items` | Максимум товаров в блоке «Недавно просмотренные» (localStorage/cookie и вывод) | `20` | 20–50 для большинства сайтов; макс. 100. Учитывается в JS при наличии ms3rvLexiconScript. |
| `ms3recentlyviewed.storage_type` | Тип хранилища списка просмотренных | `localStorage` | `localStorage` — данные в браузере до очистки; `cookie` — общий домен для поддоменов, срок 30 дней. |
| `ms3recentlyviewed.sync_enabled` | Синхронизация для авторизованных пользователей | `true` | Включить, если нужна история с разных устройств. При входе данные из localStorage переносятся в БД. |
| `ms3recentlyviewed.ttl_days` | Срок хранения записей в БД (дней) | `90` | 30–365 дней. Учитывается при автоочистке и архивировании. |
| `ms3recentlyviewed.auto_cleanup_enabled` | Автоматическая очистка старых записей | `true` | Удаляет просмотры старше TTL. Запускается раз в день при посещении сайта (плагин OnWebPageInit). |
| `ms3recentlyviewed.archive_enabled` | Месячное архивирование | `true` | Агрегирует данные за прошедший месяц в `ms3recentlyviewed_monthly` и удаляет детальные записи. Снижает размер таблицы. По умолчанию включено. |
| `ms3recentlyviewed.block_bots` | Исключать поисковых ботов | `true` | Не сохранять просмотры от краулеров (Googlebot, Yandex, Bing и др.) в БД. Определение по User-Agent. |
| `ms3recentlyviewed.track_anonymous` | Учёт просмотров анонимных пользователей | `true` | Сохранять просмотры гостей в БД. Идентификация по сессии. Требует включённой синхронизации. |
| `ms3recentlyviewed.test_ids` | ID товаров через запятую для тестовой страницы в админке | 1,2,3 | Опционально. |

## Области настроек

- **default** — `max_items`, `storage_type`, `test_ids` (фронт, блок вывода).
- **sync** — `sync_enabled`, `ttl_days`, `auto_cleanup_enabled`, `archive_enabled`, `block_bots`, `track_anonymous` (хранение в БД, плагины).

## Рекомендации

- **max_items:** 20–50 для большинства сайтов; учитывается в JS при наличии ms3rvLexiconScript.
- **storage_type:** `cookie` — если нужен общий список для поддоменов (срок cookie 30 дней).
- **archive_enabled:** по умолчанию включено; при большом объёме просмотров уменьшает размер основной таблицы.
- **block_bots:** по умолчанию включено — просмотры от краулеров не попадают в БД.
